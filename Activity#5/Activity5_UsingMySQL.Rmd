---
title: "Importing/Exporting of Data"
author: "Joyce F. Jamile"
subtitle: Use of MySQL
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Creating connections

+ You must have a database first before connecting the RStudio into a database. Depending on the database, a package should be installed like **RMySQL**, **RPostGre**, **MariaDB** to name a few.

> `dbConnect()` is being used to connect the R into MySQL

```
library(dplyr,dbplyr)
library(RMariaDB) 

#creating connections
connection <- dbConnect(RMariaDB::MariaDB(), 
                        dsn="MySQL-connection",
                        Server = "localhost",
                        dbname = "CS102_Soteo", 
                        user = "root", 
                        password = "") #PWD is the password of your MySQL
                        
```


### Listing the tables

+ Once connected, `dbListTables` to show or list the tables.



```{r}
#listing the tables of the sample_db 
dbListTables(connection)
```


```{r}
#listing the fields of the authors in the table sample_db
dbListFields(connection,"activity5")
```

### Getting data from MySQL

+ using the *`dbGetQuery`* is being used to get the data

+ SQL commands were `SELECT` and `FROM`


```{r}
act5_dta <- dbGetQuery(connection, "SELECT * FROM CS102_Soteo.activity5")
# checking for the columns and its content
glimpse(act5_dta)
```

```{r}
#getting all data using SELECT * FROM dbaseName
empi_data <- dbGetQuery(connection, "SELECT * FROM sample_db.authors")
# checking for the columns and its content
glimpse(empi_data)
```


```{r}
#getting all data using SELECT * FROM dbaseName
empi_data[c(1:10),]
```

```{r}
empi_data <- dbGetQuery(connection, "SELECT * FROM sample_db.authors")
tail(empi_data)
```

```{r}
#alternative way to display selected fields
#displays the selected fields of the table
posts_data <- dbGetQuery(connection, "SELECT title,description FROM sample_db.posts")
posts_data[c(1:2),]
```

```{r}
#getting all data using SELECT * FROM dbaseName
SqlQuery <- "
  SELECT title,description 
  FROM sample_db.posts
  "

as_tibble(dbGetQuery(connection,SqlQuery))
```

### Inserting values into a Table

```{r}
# insert values into MySQL
query <- "INSERT INTO activity5 (Usernames, Reviewer_Date, Reviewer_Content, Rating) VALUES ('=G=', '11 December 2001', 'Color me stupid but I thought *Pulp Fiction* sucked. Being creative is easy when there are no rules...as in fantasies and cartoons and, well, pulp fiction. Creativity is not easy when the rules of reality are imposed. The reason why it took me several sessions over several  years to finally assimilate this boring piece of filmdom crap is simply because its silly story and peculiar characters are one dimensional sensationalistic nonsense which almost anyone could have created and I personally found them boring...not unlike Sunday morning cartoons. Of course that criticism flies in a face of incredible popularity by the public and critics alike not to mention an Oscar and countless other awards. Go figure. Bottom line, *Pulp...* -is- pulp fiction brought to the big screen with all the gratuitous filth and violence of a dime novel but without the one thing which could really have made it interesting. Why no T&A???', '10/10')"

# Execute the query
query_result <- dbSendQuery(connection, query)

# clear the result after executing the query
dbClearResult(query_result)
```


```{r}
#checking if the value was inserted into a table
tail(empi_data)
```
```{r}
#disconnect from dbase
dbDisconnect(connection)
```